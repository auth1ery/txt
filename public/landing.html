<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>txt</title>
<style>
body{margin:0;font-family:system-ui,sans-serif;background:#0f0f0f;color:#eaeaea;display:flex;align-items:center;justify-content:center;min-height:100vh}
#container{max-width:500px;padding:2rem;text-align:center}
h1{font-size:3rem;margin:0;letter-spacing:-2px}
p{color:#aaa;line-height:1.6;margin:1.5rem 0}
input{width:100%;background:#0f0f0f;color:#eaeaea;border:1px solid #222;padding:.7rem;margin:1rem 0;font-size:1rem;box-sizing:border-box}
button{padding:.7rem 2rem;margin:1rem 0;border:1px solid #555;border-radius:.25rem;background:none;color:#aaa;cursor:pointer;font-size:1rem}
button:hover{border-color:#eaeaea;color:#fff}
.error{color:#c44;font-size:.85rem;margin-top:.5rem}
.usercount{font-size:.9rem;color:#555;margin-top:2rem}
.usercount span{color:#eaeaea;font-weight:bold}
.legal{font-size:.75rem;color:#555;margin:.5rem 0}
.legal a{color:#777;text-decoration:none}
.legal a:hover{color:#eaeaea}
#container {position: relative;z-index: 1;}
</style>
</head>
<body>
<div id="container">
<h1>txt</h1>
<p>Social media is tiring and annoying, aint it? It sells your data like free lemonade, gives you as much ads as the amount of laptops and computers produced, and desperately tries to get you addicted. We believe social media CAN be more than that!</p>
<p>On txt, literally all of that is gone. Place your thoughts here, argue in the comments (don't do that) and read other people's thoughts and such! We also have a strict no-AI policy, so no more robots in your feed!</p>
<p>It's minimal, loads on all browsers as easy as pie... dude just go make an account already!!!!!!!!!</p>
<input id="nickinput" maxlength="15" placeholder="your nickname">
<div class="error" id="error"></div>
<div class="legal">By entering, you agree to our <a href="/privacy">Privacy Policy</a> and <a href="/terms">Terms of Service</a>.</div>
<button onclick="register()">ENTER!!!!!!!!!!!</button>
<div class="usercount"><span id="count">...</span> users already here</div>
</div>
<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.position.z = 2;

const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
renderer.domElement.style.position = "fixed";
renderer.domElement.style.top = "0";
renderer.domElement.style.left = "0";
renderer.domElement.style.zIndex = "-1"; 
document.body.appendChild(renderer.domElement);

const geometry = new THREE.SphereGeometry(0.8, 16, 16);
const material = new THREE.MeshBasicMaterial({
  color: 0x888888,
  wireframe: true,
  transparent: true,
  opacity: 0.3
});
const globe = new THREE.Mesh(geometry, material);
scene.add(globe);

function animate() {
  requestAnimationFrame(animate);
  globe.rotation.y += 0.002;
  globe.rotation.x += 0.0005;
  renderer.render(scene, camera);
}
animate();

window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
<script>
if(localStorage.getItem("nickname")){
  location.href="/feed"
}
fetch("/api/usercount").then(r=>r.json()).then(d=>{
  document.getElementById("count").textContent=d.count
})
async function register(){
  const nick=document.getElementById("nickinput").value.trim().toLowerCase()
  const err=document.getElementById("error")
  if(!nick){
    err.textContent="nickname can't be empty"
    return
  }
  if(nick.length>15){
    err.textContent="nickname too long (15 max)"
    return
  }
  const r=await fetch("/api/nickname",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nickname:nick})})
  if(r.status===200){
    localStorage.setItem("nickname",nick)
    location.href="/feed"
  }else if(r.status===409){
    err.textContent="nickname already taken"
  }else if(r.status===429){
    const data = await r.json()
    err.textContent=data.error || "too many requests, slow down!"
  }else{
    err.textContent="something went wrong"
  }
}
document.getElementById("nickinput").addEventListener("keypress",e=>{
  if(e.key==="Enter") register()
})
</script>
</body>
</html>
